import{h as w,A as y}from"./api-BnkjjIlq.js";import{a as k,c as r,j as d,h as E,t as g,g as l,_ as N,d as H,r as h,n as A,B as F,y as C,w as $,D as R,o as U,E as G,m as B,f as D,b as _,F as L,e as I,u as f,M as j}from"./index-Cl8wapc-.js";import{L as q}from"./ListButton-BatumWRR.js";import{I as J}from"./IconBackArrow-ufyQHdWy.js";const K={class:"channel-list"},O=["src"],Q=k({__name:"ChannelList",props:{channelNumber:{},channelImg:{},tvgID:{},channelName:{},channel_url:{}},emits:["clickChannel"],setup(c,{emit:s}){const n=s;return(e,a)=>(l(),r("div",K,[d("div",{class:"channel-name",onClick:a[0]||(a[0]=p=>n("clickChannel",e.channel_url))},[E(g(e.channelNumber)+" ",1),d("img",{class:"channel-logo",src:e.channelImg,alt:"Channel Icon"},null,8,O),E(" "+g(e.channelName),1)])]))}}),W=N(Q,[["__scopeId","data-v-1ffd0fa9"]]),X=H("iptvChannels",()=>{const c=h();async function s(n){const{data:e}=await w.get(y.iptv_channels(n));c.value=e}return{channels:c,fetchChannels:s}}),Y=H("epgNow",()=>{const c=h();async function s(n){const{data:e}=await w.get(y.iptv_epg_now(n));c.value=e}return{epgNow:c,fetchEpgNow:s}}),Z=H("epgChannel",()=>{const c=h();async function s(n){const{data:e}=await w.get(y.iptv_epg_channel(n));c.value=e}return{epgChannel:c,fetchEpgChannel:s}}),ee=k({__name:"IconList",props:{size:{}},setup(c){return(s,n)=>(l(),r("svg",{x:"0px",y:"0px",viewBox:"0 0 122.88 96.91",style:A(`width:${s.size}px; height:${s.size}px;`),"xml:space":"preserve"},n[0]||(n[0]=[d("g",null,[d("path",{class:"st0",d:"M122.88,0v20.05H33.2V0H122.88L122.88,0z M21.13,76.86v20.05H0V76.86H21.13L21.13,76.86z M21.13,38.43v20.05H0 V38.43H21.13L21.13,38.43z M21.13,0v20.05H0V0H21.13L21.13,0z M122.88,76.86v20.05H33.2V76.86H122.88L122.88,76.86z M122.88,38.43 v20.05H33.2V38.43H122.88L122.88,38.43z"})],-1)]),4))}}),ne=N(ee,[["__scopeId","data-v-a6e990d7"]]),te={class:"channel-epg"},ae=k({__name:"EpgNowList",props:{channel_id:{}},emits:["clickEpgButton"],setup(c,{emit:s}){const n=s;return(e,a)=>(l(),r("div",te,[F(e.$slots,"default",{},void 0),d("div",null,[C(q,{onClick:a[0]||(a[0]=p=>n("clickEpgButton",e.channel_id))},{default:$(()=>[C(ne,{size:20})]),_:1})])]))}}),se=N(ae,[["__scopeId","data-v-1da76f82"]]),le={class:"epg-date"},oe={class:"epg-channel-title"},ce=k({__name:"EpgChannel",props:{start:{},end:{},title:{},epg_url:{}},emits:["clickEpgHistory"],setup(c,{emit:s}){const n=s,e=()=>{const t=new Date,u=new Date(c.start),v=new Date(c.end);return t>v?"past":t>=u&&t<=v?"current":"future"};function a(t){return new Date(t).toLocaleString("ru-RU",{month:"2-digit",day:"2-digit",weekday:"short"})}function p(t){return new Date(t).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",hour12:!1})}return(t,u)=>(l(),r("div",{class:R(["epg-channel",e()]),onClick:u[0]||(u[0]=v=>n("clickEpgHistory",t.epg_url)),ref:"programStatus"},[d("div",le,g(a(t.start))+" "+g(p(t.start)),1),d("div",oe,g(t.title),1)],2))}}),re=N(ce,[["__scopeId","data-v-222859e3"]]),ie={key:1,class:"playlist-group"},ue={key:2,class:"playlist-channels"},pe={key:0},he={key:3},ge=k({__name:"IPTVView",setup(c){const s=h(),n=h(!0),e=h(!1),a=h(!1),p=X(),t=Y(),u=Z(),v=h(null);async function T(){const{data:i}=await w.get(y.iptv_group);s.value=i}U(()=>{T(),a.value&&S()});function M(i){n.value=!n.value,e.value=!e.value,p.channels=[],t.epgNow=[],u.epgChannel=[],p.fetchChannels(i),t.fetchEpgNow(i)}function b(i){a.value=!a.value,e.value=!e.value,u.fetchEpgChannel(i)}function P(){a.value?(a.value=!a.value,e.value=!0,u.epgChannel=[]):e.value&&(e.value=!e.value,n.value=!n.value,p.channels=[],t.epgNow=[])}async function x(i){const{data:z}=await w.post(y.iptv_play,{url:i});console.log(z)}function V(i){x(i)}const S=async()=>{await G(),setTimeout(()=>{const i=v.value?.querySelector(".epg-channel.current");i&&i.scrollIntoView({behavior:"smooth",block:"center"})},100)};return B(()=>u.epgChannel,()=>{a.value&&S()}),B(()=>t.epgNow,()=>{console.log(t.epgNow)}),(i,z)=>(l(),r(L,null,[n.value?_("",!0):(l(),D(J,{key:0,size:70,onClick:P})),n.value&&!e.value&&!a.value?(l(),r("div",ie,[(l(!0),r(L,null,I(s.value,(o,m)=>(l(),D(j,{key:m,onClick:de=>M(o)},{default:$(()=>[E(g(o),1)]),_:2},1032,["onClick"]))),128))])):_("",!0),e.value&&!n.value&&!a.value?(l(),r("div",ue,[(l(!0),r(L,null,I(f(p).channels,(o,m)=>(l(),r("div",{key:o.id},[C(W,{channel_url:o.url,"channel-number":m+1,"channel-img":o.tvg_logo,tvgID:o.tvg_id,"channel-name":o.channel_name,onClickChannel:V},null,8,["channel_url","channel-number","channel-img","tvgID","channel-name"]),f(t).epgNow&&f(t).epgNow[o.id]?(l(),r("div",pe,[C(se,{channel_id:o.tvg_id,onClickEpgButton:b},{default:$(()=>[E(g(f(t).epgNow[o.id]),1)]),_:2},1032,["channel_id"])])):_("",!0)]))),128))])):_("",!0),a.value&&!n.value&&!e.value?(l(),r("div",he,[f(u).epgChannel?(l(),r("div",{key:0,class:"epg-list-container",ref_key:"epgListContainer",ref:v},[(l(!0),r(L,null,I(f(u).epgChannel,(o,m)=>(l(),r("div",{key:m},[C(re,{epg_url:o.url,start:o.start,end:o.end,title:o.title,onClickEpgHistory:V},null,8,["epg_url","start","end","title"])]))),128))],512)):_("",!0)])):_("",!0)],64))}}),Ce=N(ge,[["__scopeId","data-v-8c99e8fc"]]);export{Ce as default};
